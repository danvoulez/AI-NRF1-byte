{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://schemas.ai-ai-nrf1/reasoning.bit.v1.json",
  "type": "object",
  "required": [
    "v",
    "t",
    "context_cid",
    "engine",
    "usage",
    "judgment",
    "trace",
    "rt",
    "sig"
  ],
  "properties": {
    "v": {
      "type": "string",
      "const": "reasoning.bit.v1"
    },
    "t": {
      "type": "string",
      "description": "RFC3339 UTC Z"
    },
    "context_cid": {
      "type": "string",
      "pattern": "^b3:[a-f0-9]{64}$"
    },
    "engine": {
      "type": "object",
      "required": [
        "profile"
      ],
      "properties": {
        "profile": {
          "enum": [
            "LLM-Engine",
            "LLM-Smart"
          ]
        },
        "provider": {
          "type": "string"
        },
        "model": {
          "type": "string"
        },
        "runtime": {
          "type": "string"
        },
        "model_sha256": {
          "type": "string"
        },
        "escalated_from": {
          "enum": [
            "LLM-Smart",
            "LLM-Engine",
            null
          ]
        }
      }
    },
    "usage": {
      "type": "object",
      "required": [
        "input_tokens",
        "output_tokens",
        "hrd_score"
      ],
      "properties": {
        "input_tokens": {
          "type": "integer",
          "minimum": 0
        },
        "output_tokens": {
          "type": "integer",
          "minimum": 0
        },
        "hrd_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    },
    "judgment": {
      "type": "object",
      "required": [
        "verdict",
        "confidence",
        "reasoning"
      ],
      "properties": {
        "verdict": {
          "enum": [
            "PASS",
            "FAIL",
            "NEEDS_REVIEW"
          ]
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "reasoning": {
          "type": "string"
        }
      }
    },
    "trace": {
      "type": "object",
      "required": [
        "prompt_hash",
        "policy"
      ],
      "properties": {
        "prompt_hash": {
          "type": "string",
          "pattern": "^b3:[a-f0-9]{64}$"
        },
        "policy": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "rt": {
      "type": "object",
      "required": [
        "binary_sha256",
        "version"
      ],
      "properties": {
        "binary_sha256": {
          "type": "string",
          "pattern": "^sha256:[a-f0-9]{64}$"
        },
        "version": {
          "type": "string"
        }
      }
    },
    "sig": {
      "type": "string",
      "description": "Ed25519 over NRF bytes (sig-of-canon, not JSON)"
    }
  }
}
